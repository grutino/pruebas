10 REM *** BATALLA DE TANQUES PARA ZX SPECTRUM ***
20 RANDOMIZE
30 CLS
40 PRINT "BATALLA DE TANQUES"
50 PRINT "ELIGE ANGULO (10-80) Y POTENCIA (10-100)"
60 PRINT "PULSA UNA TECLA PARA EMPEZAR"
70 PAUSE 0
80 CLS
90 LET W=30
100 LET H=15
110 LET GR=0.28
120 DIM G(W)
130 LET G(1)=INT (6+RND*4)
140 FOR I=2 TO W
150 LET G(I)=G(I-1)+INT (RND*5)-2
160 IF G(I)<3 THEN LET G(I)=3
170 IF G(I)>H THEN LET G(I)=H
180 NEXT I
190 LET L=3
200 LET R=W-2
210 LET TL=G(L)
220 LET TR=G(R)
230 FOR I=L-1 TO L+1
240 LET G(I)=TL
250 NEXT I
260 FOR I=R-1 TO R+1
270 LET G(I)=TR
280 NEXT I
290 LET TURN=0
300 LET WON=0
310 LET EXPX=0
320 LET EXPY=0
330 GO TO 360
340 LET EXPX=0
350 LET EXPY=0
360 GO SUB 500
370 IF TURN=0 THEN GO SUB 600
375 IF TURN<>0 THEN GO SUB 1000
380 IF WON=1 THEN GO TO 1400
390 LET TURN=1-TURN
400 GO TO 340
500 CLS
510 FOR Y=H+6 TO 0 STEP -1
520 LET LINE$=""
530 FOR X=1 TO W
540 LET CH$=" "
550 IF Y<=G(X) THEN LET CH$="#"
560 IF X=L AND Y=G(L)+1 THEN LET CH$="1"
570 IF X=R AND Y=G(R)+1 THEN LET CH$="2"
580 IF EXPX>0 AND X=EXPX AND Y=EXPY THEN LET CH$="*"
590 LET LINE$=LINE$+CH$
600 NEXT X
610 PRINT LINE$
620 NEXT Y
630 PRINT STRING$(W,"-")
640 RETURN
600 REM TURNO DEL TANQUE IZQUIERDO
610 PRINT
620 PRINT "TURNO TANQUE IZQUIERDO"
630 INPUT "ANGULO (10-80) ";A
640 IF A<10 OR A>80 THEN PRINT "ANGULO FUERA DE RANGO": GO TO 630
650 INPUT "POTENCIA (10-100) ";P
660 IF P<10 OR P>100 THEN PRINT "POTENCIA FUERA DE RANGO": GO TO 650
670 LET AR=A*PI/180
680 LET V=P/15
690 LET Y0=G(L)+1
700 LET MS$="DISPARO PERDIDO"
710 LET EXPX=0
720 LET EXPY=0
730 LET DONE=0
740 FOR TM=0 TO 10 STEP 0.2
750 LET X=L+V*TM*COS AR
760 LET Y=Y0+V*TM*SIN AR-GR*TM*TM
770 LET CX=INT (X+0.5)
780 LET CY=INT (Y+0.5)
790 IF CX<1 OR CX>W THEN LET DONE=1: GO TO 900
800 IF CX=R AND CY<=G(R)+2 THEN LET WON=1: LET EXPX=CX: LET EXPY=G(R)+1: LET MS$="IMPACTO DIRECTO!": LET DONE=1: GO TO 900
810 IF CY<=G(CX) THEN LET EXPX=CX: LET OLD=G(CX): LET EXPY=OLD+1: LET CR=INT (1+RND*2): LET G(CX)=OLD-CR: IF G(CX)<0 THEN LET G(CX)=0: LET MS$="EXPLOSION EN LA MONTAÑA": LET DONE=1: GO TO 900
820 NEXT TM
830 GO TO 910
900 REM SALIDA DEL BUCLE
910 IF DONE=0 THEN LET EXPX=0: LET EXPY=0
920 GO SUB 500
930 PRINT
940 PRINT MS$
950 PAUSE 120
960 RETURN
1000 REM TURNO DEL TANQUE DERECHO
1010 PRINT
1020 PRINT "TURNO TANQUE DERECHO"
1030 INPUT "ANGULO (10-80) ";A
1040 IF A<10 OR A>80 THEN PRINT "ANGULO FUERA DE RANGO": GO TO 1030
1050 INPUT "POTENCIA (10-100) ";P
1060 IF P<10 OR P>100 THEN PRINT "POTENCIA FUERA DE RANGO": GO TO 1050
1070 LET AR=A*PI/180
1080 LET V=P/15
1090 LET Y0=G(R)+1
1100 LET MS$="DISPARO PERDIDO"
1110 LET EXPX=0
1120 LET EXPY=0
1130 LET DONE=0
1140 FOR TM=0 TO 10 STEP 0.2
1150 LET X=R-V*TM*COS AR
1160 LET Y=Y0+V*TM*SIN AR-GR*TM*TM
1170 LET CX=INT (X+0.5)
1180 LET CY=INT (Y+0.5)
1190 IF CX<1 OR CX>W THEN LET DONE=1: GO TO 1290
1200 IF CX=L AND CY<=G(L)+2 THEN LET WON=1: LET EXPX=CX: LET EXPY=G(L)+1: LET MS$="IMPACTO DIRECTO!": LET DONE=1: GO TO 1290
1210 IF CY<=G(CX) THEN LET EXPX=CX: LET OLD=G(CX): LET EXPY=OLD+1: LET CR=INT (1+RND*2): LET G(CX)=OLD-CR: IF G(CX)<0 THEN LET G(CX)=0: LET MS$="EXPLOSION EN LA MONTAÑA": LET DONE=1: GO TO 1290
1220 NEXT TM
1230 GO TO 1300
1290 REM SALIDA DEL BUCLE
1300 IF DONE=0 THEN LET EXPX=0: LET EXPY=0
1310 GO SUB 500
1320 PRINT
1330 PRINT MS$
1340 PAUSE 120
1350 RETURN
1400 PRINT
1410 IF TURN=0 THEN PRINT "EL TANQUE IZQUIERDO HA GANADO"
1415 IF TURN<>0 THEN PRINT "EL TANQUE DERECHO HA GANADO"
1420 PRINT "¿OTRA PARTIDA (S/N)?"
1430 INPUT OP$
1440 IF OP$="S" OR OP$="s" THEN RUN
1450 PRINT "HASTA LA PROXIMA"
1460 STOP